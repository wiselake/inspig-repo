-- ============================================================
-- TM_WEATHER_ASOS: ASOS 관측소 메타정보 테이블
-- 기상청 종관기상관측(ASOS) 관측소 정보 관리
--
-- 용도:
--   - ASOS 일자료 수집 시 가장 가까운 관측소 매핑
--   - 농장별 관측소 캐싱 (TA_FARM.ASOS_STN_ID)
--   - 관측소 추가/변경 시 유연한 대응
--
-- 데이터 출처:
--   - 기상자료개방포털: https://data.kma.go.kr/tmeta/stn/selectStnList.do
--   - 기상청 API 허브: https://apihub.kma.go.kr
--
-- 실행 순서: 02_TABLE.sql 실행 후 실행
-- ============================================================

-- 테이블 생성 (존재시 삭제)
BEGIN
    EXECUTE IMMEDIATE 'DROP TABLE TM_WEATHER_ASOS CASCADE CONSTRAINTS';
EXCEPTION
    WHEN OTHERS THEN NULL;
END;
/

CREATE TABLE TM_WEATHER_ASOS (
    STN_ID          INTEGER NOT NULL,                   -- 관측소 지점번호 (PK)
    STN_NM          VARCHAR2(50) NOT NULL,              -- 관측소명 (한글)
    STN_NM_EN       VARCHAR2(50),                       -- 관측소명 (영문)
    LAT             NUMBER(10,6) NOT NULL,              -- 위도
    LON             NUMBER(10,6) NOT NULL,              -- 경도
    ALTITUDE        NUMBER(6,1),                        -- 해발고도 (m)
    ADDR            VARCHAR2(200),                      -- 주소
    OPEN_DT         VARCHAR2(8),                        -- 개설일 (YYYYMMDD)
    CLOSE_DT        VARCHAR2(8),                        -- 폐쇄일 (YYYYMMDD, NULL=운영중)
    USE_YN          VARCHAR2(1) DEFAULT 'Y',            -- 사용여부
    LOG_INS_DT      DATE DEFAULT SYSDATE,              -- 생성일
    LOG_UPT_DT      DATE,                              -- 수정일

    CONSTRAINT PK_TM_WEATHER_ASOS PRIMARY KEY (STN_ID)
)
TABLESPACE PIGXE_DATA;

-- 인덱스
CREATE INDEX IDX_TM_WEATHER_ASOS_01 ON TM_WEATHER_ASOS(USE_YN) TABLESPACE PIGXE_IDX;
CREATE INDEX IDX_TM_WEATHER_ASOS_02 ON TM_WEATHER_ASOS(LAT, LON) TABLESPACE PIGXE_IDX;

COMMENT ON TABLE TM_WEATHER_ASOS IS 'ASOS 종관기상관측 관측소 메타정보';
COMMENT ON COLUMN TM_WEATHER_ASOS.STN_ID IS '관측소 지점번호 (기상청 기준)';
COMMENT ON COLUMN TM_WEATHER_ASOS.STN_NM IS '관측소명 (한글)';
COMMENT ON COLUMN TM_WEATHER_ASOS.STN_NM_EN IS '관측소명 (영문)';
COMMENT ON COLUMN TM_WEATHER_ASOS.LAT IS '위도';
COMMENT ON COLUMN TM_WEATHER_ASOS.LON IS '경도';
COMMENT ON COLUMN TM_WEATHER_ASOS.ALTITUDE IS '해발고도 (m)';
COMMENT ON COLUMN TM_WEATHER_ASOS.ADDR IS '주소';
COMMENT ON COLUMN TM_WEATHER_ASOS.OPEN_DT IS '개설일 (YYYYMMDD)';
COMMENT ON COLUMN TM_WEATHER_ASOS.CLOSE_DT IS '폐쇄일 (YYYYMMDD, NULL=운영중)';
COMMENT ON COLUMN TM_WEATHER_ASOS.USE_YN IS '사용여부 (Y/N)';
COMMENT ON COLUMN TM_WEATHER_ASOS.LOG_INS_DT IS '생성일';
COMMENT ON COLUMN TM_WEATHER_ASOS.LOG_UPT_DT IS '수정일';

-- ============================================================
-- 초기 데이터: ASOS 주요 관측소 97개
-- 출처: 기상청 기상자료개방포털 관측지점 메타정보
-- ============================================================
INSERT ALL
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (90, '속초', 38.2509, 128.5647)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (93, '북춘천', 37.9369, 127.7356)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (95, '철원', 38.1479, 127.3042)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (98, '동두천', 37.9019, 127.0606)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (99, '파주', 37.8856, 126.7672)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (100, '대관령', 37.6769, 128.7189)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (101, '춘천', 37.9026, 127.7357)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (102, '백령도', 37.9667, 124.6303)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (104, '북강릉', 37.8044, 128.8556)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (105, '강릉', 37.7514, 128.8908)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (106, '동해', 37.5071, 129.1242)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (108, '서울', 37.5714, 126.9658)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (112, '인천', 37.4775, 126.6247)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (114, '원주', 37.3375, 127.9464)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (115, '울릉도', 37.4808, 130.8989)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (116, '관악산', 37.4436, 126.9658)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (119, '수원', 37.2703, 126.9875)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (121, '영월', 37.1828, 128.4589)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (127, '충주', 36.9703, 127.9528)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (129, '서산', 36.7742, 126.4939)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (130, '울진', 36.9917, 129.4131)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (131, '청주', 36.6392, 127.4403)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (133, '대전', 36.3722, 127.3722)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (135, '추풍령', 36.2200, 127.9956)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (136, '안동', 36.5728, 128.7075)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (137, '상주', 36.4119, 128.1589)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (138, '포항', 36.0328, 129.3797)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (140, '군산', 35.9922, 126.7117)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (143, '대구', 35.8850, 128.6189)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (146, '전주', 35.8214, 127.1547)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (152, '울산', 35.5600, 129.3200)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (155, '창원', 35.1700, 128.5728)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (156, '광주', 35.1728, 126.8914)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (159, '부산', 35.1047, 129.0319)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (162, '통영', 34.8453, 128.4356)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (165, '목포', 34.8167, 126.3811)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (168, '여수', 34.7394, 127.7406)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (169, '흑산도', 34.6856, 125.4519)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (170, '완도', 34.3961, 126.7028)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (172, '고창', 35.4328, 126.6983)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (174, '순천', 35.0694, 127.0328)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (177, '홍성', 36.4350, 126.6594)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (184, '제주', 33.5142, 126.5297)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (185, '고산', 33.2931, 126.1628)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (188, '성산', 33.3869, 126.8789)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (189, '서귀포', 33.2461, 126.5653)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (192, '진주', 35.1636, 128.0403)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (201, '강화', 37.7075, 126.4467)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (202, '양평', 37.4886, 127.4944)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (203, '이천', 37.2644, 127.4844)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (211, '인제', 38.0600, 128.1706)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (212, '홍천', 37.6836, 127.8803)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (216, '태백', 37.1717, 128.9889)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (217, '정선군', 37.3808, 128.6594)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (221, '제천', 37.1592, 128.1942)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (226, '보은', 36.4875, 127.7344)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (232, '천안', 36.7642, 127.2903)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (235, '보령', 36.3267, 126.5575)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (236, '부여', 36.2722, 126.9211)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (238, '금산', 36.1053, 127.4806)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (243, '부안', 35.7294, 126.7164)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (244, '임실', 35.6117, 127.2869)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (245, '정읍', 35.5628, 126.8658)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (247, '남원', 35.4042, 127.3325)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (248, '장수', 35.6464, 127.5211)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (251, '고창군', 35.4328, 126.6983)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (252, '영광군', 35.2783, 126.5106)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (253, '김해시', 35.2286, 128.8894)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (254, '순창군', 35.3742, 127.1375)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (255, '북창원', 35.2544, 128.6647)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (256, '양산시', 35.3150, 129.0372)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (257, '보성군', 34.7636, 127.0800)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (258, '강진군', 34.6417, 126.7667)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (259, '장흥', 34.6894, 126.9183)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (260, '해남', 34.5536, 126.5692)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (261, '고흥', 34.6175, 127.2758)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (262, '의령군', 35.3222, 128.2614)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (263, '함양군', 35.5203, 127.7253)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (264, '광양시', 34.9400, 127.6956)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (266, '합천', 35.5650, 128.1656)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (268, '밀양', 35.4906, 128.7439)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (271, '봉화', 36.9433, 128.9144)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (272, '영주', 36.8719, 128.5169)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (273, '문경', 36.6269, 128.1486)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (276, '청송군', 36.4361, 129.0572)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (277, '영덕', 36.5331, 129.4092)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (278, '의성', 36.3525, 128.6878)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (279, '구미', 36.1306, 128.3206)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (281, '영천', 35.9731, 128.9514)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (283, '경주시', 35.8428, 129.2128)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (284, '거창', 35.6711, 127.9097)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (285, '합천군', 35.5650, 128.1656)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (288, '산청', 35.4150, 127.8781)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (289, '거제', 34.8883, 128.6044)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (294, '남해', 34.8167, 127.8933)
    INTO TM_WEATHER_ASOS (STN_ID, STN_NM, LAT, LON) VALUES (295, '북부산', 35.2136, 129.0317)
SELECT 1 FROM DUAL;

COMMIT;

-- 데이터 확인
SELECT COUNT(*) AS ASOS_STN_CNT FROM TM_WEATHER_ASOS;
